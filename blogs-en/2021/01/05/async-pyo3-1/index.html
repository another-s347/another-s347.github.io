<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Hexo</title><link rel="manifest" href="/blogs-en/manifest.json"><meta name="application-name" content="Hexo"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hexo"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="Async across language with pyo3Before get startedThis note requires some basic knowledge and understanding of what is async and how async works.  I appreciate any tech or non-tech advices about the pr"><meta property="og:type" content="blog"><meta property="og:title" content="Hexo"><meta property="og:url" content="http://another-s347.github.io/blogs-en/2021/01/05/async-pyo3-1/"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="Async across language with pyo3Before get startedThis note requires some basic knowledge and understanding of what is async and how async works.  I appreciate any tech or non-tech advices about the pr"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://another-s347.github.io/blogs-en/img/og_image.png"><meta property="article:published_time" content="2021-01-05T14:24:27.938Z"><meta property="article:modified_time" content="2021-01-05T14:24:27.938Z"><meta property="article:author" content="another-s347"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/blogs-en/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://another-s347.github.io/blogs-en/2021/01/05/async-pyo3-1/"},"headline":"Hexo","image":["http://another-s347.github.io/blogs-en/img/og_image.png"],"datePublished":"2021-01-05T14:24:27.938Z","dateModified":"2021-01-05T14:24:27.938Z","author":{"@type":"Person","name":"another-s347"},"description":"Async across language with pyo3Before get startedThis note requires some basic knowledge and understanding of what is async and how async works.  I appreciate any tech or non-tech advices about the pr"}</script><link rel="canonical" href="http://another-s347.github.io/blogs-en/2021/01/05/async-pyo3-1/"><link rel="icon" href="/blogs-en/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/blogs-en/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/blogs-en/"><img src="/blogs-en/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/blogs-en/">Home</a><a class="navbar-item" href="/blogs-en/archives">Archives</a><a class="navbar-item" href="/blogs-en/categories">Categories</a><a class="navbar-item" href="/blogs-en/tags">Tags</a><a class="navbar-item" href="/blogs-en/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-01-05T14:24:27.938Z" title="2021-01-05T14:24:27.938Z">2021-01-05</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-01-05T14:24:27.938Z" title="2021-01-05T14:24:27.938Z">2021-01-05</time></span><span class="level-item">7 minutes read (About 1072 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"> </h1><div class="content"><h2 id="Async-across-language-with-pyo3"><a href="#Async-across-language-with-pyo3" class="headerlink" title="Async across language with pyo3"></a>Async across language with pyo3</h2><h3 id="Before-get-started"><a href="#Before-get-started" class="headerlink" title="Before get started"></a>Before get started</h3><p>This note requires some basic knowledge and understanding of what is async and how async works. </p>
<p>I appreciate any tech or non-tech advices about the problems in the article, like grammar, spelling or expression.</p>
<h3 id="Basic-async-in-python"><a href="#Basic-async-in-python" class="headerlink" title="Basic async in python"></a>Basic async in python</h3><p>A basic async function in python looks like this, which is very similar to async in other language like JavaScript or C#.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">socket</span>):</span></span><br><span class="line">    data = <span class="keyword">await</span> socket.read(<span class="number">1000</span>)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<p><code>read</code> itself is just a normal function. But by calling this function <code>read</code> under normal context (without async), it produces a <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0492/#coroutine-objects"><code>coroutine object</code></a>. Noted, the body of <code>read</code> is not actually executed.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>read(<span class="string">&quot;whatever&quot;</span>)</span><br><span class="line">&lt;coroutine <span class="built_in">object</span> read at 0x.......&gt;</span><br></pre></td></tr></table></figure>

<p>The coroutine object is like a instance of <code>future</code> in Rust and it is stackless. It contains the execution flow, variables, states…etc. There are many high-level ways to create a coroutine object, like <code>@asyncio.coroutine</code> annotation, generator based coroutine. But we won’t coverd them here. We need a way to implement async by hand. Specifically, we want to write a class which can be <code>await</code>ed.</p>
<h3 id="Implement-a-basic-awaitable-object"><a href="#Implement-a-basic-awaitable-object" class="headerlink" title="Implement a basic awaitable object"></a>Implement a basic awaitable object</h3><p>According to PEP492:</p>
<blockquote>
<p>await only accepts an awaitable, which can be one of:</p>
<p>blablabla</p>
<p>An object with an <code>__await__</code> method returning an iterator.</p>
</blockquote>
<p>This is a good start. The <code>__await__</code> method can return itself, or create multiple different objects. </p>
<p>The returned iterator is the object we actually want. In a simplified context, the executor of asyncio (or any other library) would call <code>__next__</code> on the iterator to make progress on the task. It’s like the <code>poll</code> in Rust’s <code>Future</code>. If the object get its result (for example the data from remote peer), the <code>__next__</code> need to call <code>raise StopIteration(result)</code> to finish the execute.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyAwait</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self.n = n</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">raise</span> StopIteration(self.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span>  <span class="title">__await__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.n += <span class="number">1</span></span><br><span class="line">        print(<span class="string">&quot;await on MyAwait&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> MyIter(self.n)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyIter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self.n = n</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">raise</span> StopIteration(self.n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    a = MyAwait(<span class="number">1</span>)</span><br><span class="line">    print(<span class="keyword">await</span> a) <span class="comment"># will print &quot;await on MyAwait&quot; and &quot;2&quot;</span></span><br><span class="line">    print(<span class="keyword">await</span> a) <span class="comment"># will print &quot;await on MyAwait&quot; and &quot;3&quot;</span></span><br><span class="line"></span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure>
<p>Now we have our first custom awaitable object. But it is useless, because it do not have anything to express pending status or do anything with the executor (the loop in the source code of asyncio). We need to find some clue in the source code.</p>
<h3 id="Asyncio"><a href="#Asyncio" class="headerlink" title="Asyncio"></a>Asyncio</h3><p>If the <code>__next__</code> in MyIter return a int like 1, we will have a error like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Task got bad yield: 1</span><br></pre></td></tr></table></figure>
<p>This error is raised from the code of asyncio, located at <code>/usr/lib/python3.8/asyncio/tasks.py:__step at line 340</code>.</p>
<p>In fact, there is no standard or PEP of how to design the executor. Since <code>asyncio</code> is the offical library in the ecosystem of async python, we will stick to it to find our answers. And of course, you can design your own object and executor that is not compatible with asyncio.</p>
<p>The first key point with asyncio is: asyncio has its own type to represent async task. To avoid misunderstanding, I will list related types here:</p>
<ol>
<li>python’s <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-3148/"><code>Future</code> (PEP-3184)</a>: a old type to express result from the future, or async as we call here.</li>
<li>asyncio’s <code>Future</code>: almost compatible with python’s <code>Future</code>, with some differences and new methods. Located at <code>asyncio/futures.py</code>. This is the type our object should be based on or be compatible with.</li>
<li>asyncio’s <code>Task</code>: a instance of async task that controls the execution of our code. Located at <code>asyncio/tasks.py</code>.</li>
</ol>
<p>The <code>__step</code> in <code>asyncio/tasks.py</code> is where we should foucs on. After digging around and ignoring dozens of type-check, the important lines are 298-320:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `result` is the iterator we created</span></span><br><span class="line">blocking = <span class="built_in">getattr</span>(result, <span class="string">&#x27;_asyncio_future_blocking&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"><span class="keyword">if</span> blocking <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># Yielded Future must come from Future.__iter__().</span></span><br><span class="line">    <span class="keyword">if</span> futures._get_loop(result) <span class="keyword">is</span> <span class="keyword">not</span> self._loop:</span><br><span class="line">        new_exc = RuntimeError(</span><br><span class="line">            <span class="string">f&#x27;Task <span class="subst">&#123;self!r&#125;</span> got Future &#x27;</span></span><br><span class="line">            <span class="string">f&#x27;<span class="subst">&#123;result!r&#125;</span> attached to a different loop&#x27;</span>)</span><br><span class="line">        self._loop.call_soon(</span><br><span class="line">            self.__step, new_exc, context=self._context)</span><br><span class="line">    <span class="keyword">elif</span> blocking:</span><br><span class="line">        <span class="keyword">if</span> result <span class="keyword">is</span> self:</span><br><span class="line">            new_exc = RuntimeError(</span><br><span class="line">                <span class="string">f&#x27;Task cannot await on itself: <span class="subst">&#123;self!r&#125;</span>&#x27;</span>)</span><br><span class="line">            self._loop.call_soon(</span><br><span class="line">                self.__step, new_exc, context=self._context)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result._asyncio_future_blocking = <span class="literal">False</span></span><br><span class="line">            result.add_done_callback(</span><br><span class="line">                self.__wakeup, context=self._context)</span><br><span class="line">            self._fut_waiter = result</span><br><span class="line">            <span class="keyword">if</span> self._must_cancel:</span><br><span class="line">                <span class="keyword">if</span> self._fut_waiter.cancel():</span><br><span class="line">                    self._must_cancel = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p>We can see that we need:</p>
<ol>
<li>a <code>_asyncio_future_blocking</code> attribute (type bool) to tell the executor whether it is blocked (by executor) currently. Details can be found at <code>asyncio/futures.py</code>.</li>
<li>a <code>_loop</code> attribute that gives the executor running this task.</li>
<li>a <code>add_done_callback</code> method to store the callback from executor, the callback should be called when our async task is done. The callback is like the <code>waker</code> in Rust. Noted that the callback should not be called multiple times. So some cleanup and checks are needed. If the <code>add_done_callback</code> is called after it is done, the callback should be called immediately or our task won’t get waked from executor.</li>
<li>a <code>result</code> method which return the result of the future or exception if any. Asyncio calls it for exception checking, not actually return the result.</li>
</ol>
<h3 id="Take-a-shot"><a href="#Take-a-shot" class="headerlink" title="Take a shot"></a>Take a shot</h3><p>A minimal, asyncio-compatible custom awaitable would be like this:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyAwait</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self.n = n</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">raise</span> StopIteration(self.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span>  <span class="title">__await__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.n += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> MyIter(self.n)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyIter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self.state = <span class="number">0</span></span><br><span class="line">        self.n = n</span><br><span class="line">        self._asyncio_future_blocking = <span class="literal">True</span></span><br><span class="line">        self._loop = asyncio.get_event_loop()</span><br><span class="line">        self.callbacks = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_done_callback</span>(<span class="params">self, m, context</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.state == <span class="number">1</span>: </span><br><span class="line">            self.callbacks.append((m, context))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self._loop.call_soon(m, self, context=context)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.n != <span class="number">5</span>:</span><br><span class="line">            self.n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> m, c <span class="keyword">in</span> self.callbacks:</span><br><span class="line">                self._loop.call_soon(m, self, context=c)</span><br><span class="line">            self.callbacks = []</span><br><span class="line"></span><br><span class="line">            self._asyncio_future_blocking = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">        self.state = <span class="number">1</span></span><br><span class="line">        <span class="keyword">raise</span> StopIteration(self.n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">result</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;whatever&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0492/">PEP 492 – Coroutines with async and await syntax</a></li>
</ul>
<h4 id="License"><a href="#License" class="headerlink" title="License"></a>License</h4><p><a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en">CC BY-NC-SA 4.0</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p><a href="http://another-s347.github.io/blogs-en/2021/01/05/async-pyo3-1/">http://another-s347.github.io/blogs-en/2021/01/05/async-pyo3-1/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>another-s347</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-01-05</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-01-05</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="/blogs-en/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/blogs-en/" alt="Alipay"></span></a><a class="button donate" href="/blogs-en/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/blogs-en/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/blogs-en/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/blogs-en/2021/01/05/dummy/"><span class="level-item"> </span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/blogs-en/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/blogs-en/archives"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/blogs-en/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/blogs-en/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/blogs-en/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-05T14:24:27.938Z">2021-01-05</time></p><p class="title"><a href="/blogs-en/2021/01/05/async-pyo3-1/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-05T14:24:09.914Z">2021-01-05</time></p><p class="title"><a href="/blogs-en/2021/01/05/dummy/"> </a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blogs-en/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/blogs-en/"><img src="/blogs-en/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2021 another-s347</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/blogs-en/js/column.js"></script><script src="/blogs-en/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/blogs-en/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/blogs-en/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/blogs-en/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/blogs-en/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>